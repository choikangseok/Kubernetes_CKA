## Services

#### 포드의 문제점 : 포드의 문제점으로 인해 서비스가 필요하다.
 - 포드는 일시적으로 생성한 컨테이너의 집합
 - 때문에 포드가 지속적으로 생겨났을 때 서비스를 하기에 적합하지 안흥ㅁ
 - IP 주소의 지속적으로 변동, 로드밸런싱을 관리해줄 또 다른 개체가 필요
 - 이 문제를 해결해주는 서비스라는 리소스가 존재한다.

#### 서비스의 요구사항
- 외부 클라이언트가 몇 개이든지 프론트엔드 포드로 연결
- 프론트엔드는 다시 백엔드 데이터베이스로 연결
- 포드의 IP가 변경될 때 마다 재설정 하지 않도록 해야한다.

#### 서비스 생성방법
- kubectl expose ( 쉬운 방법)
- YAML을 통해 버전 관리 가능

#### ClustrerIP?


#### 서비스 세션 고정하기 ( 로그인을 예제로 생각)
- 서비스가 다수의 포드로 구성하면 웹서비스의 세션이 유지되지 않음
- 이를 위해 처음 들어왔던 클라이언트 IP를 그대로 유지해주는 방법이 필요
- sessionAffnity: ClientIP라는 옵션을 주면 해결 완료!

#### 다중 포트 서비스 방법
- 포트에 그대로 나열해서 사용

#### External IP
- 외부 IP와도 연동이 가능 (Service 와 Endpoints 둘다 만들어 주어야 함)
- 내부 -> 로드밸런싱 -> 외부

*Tip*: 쿠버네티스 Yaml파일에서 s(복수형)가 붙는건 리스트를 의심해보자!

```
# 서비스하는 IP 정보 확인 (External)
$ kubectl describe svc <servicename>
```


#### 서비스를 노출하는 세가지 방법
- NodePort: 노드의 자체 포트를 사용하여 포드로 리다이렉션
- loadBalancer: 외부 게이트웨이를 사용해 노드 포트로 리다이렉션
- Ingress: 하나의 IP 주소를 통해 여러 서비스를 제공하는 특별한 매커니즘

##### NodePort
- 30000-32767포트만 사용가능하다.
